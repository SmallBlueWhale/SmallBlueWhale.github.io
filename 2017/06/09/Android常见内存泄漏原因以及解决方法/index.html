<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    <title>Android常见内存泄漏原因以及解决方法 | SmallBlueWhale&#39;s blog | Real Life</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#99CCFF">
    
    
    <meta name="keywords" content="Android,Context,Handler &amp;&amp; InnerClass,Memory Leak,Static">
    <meta name="description" content="HandlerHandler出现内存泄漏的原因，handler内部持有了一个context对象，同时如果这个对象因为handler消息未发送完成导致context对象一直无法被销毁，出现内存泄漏，同时如果我们新开一个线程去发送消息的话，也会因此出现内存泄漏。如下：
123456new Thread(new Runnable()&amp;#123;  @Override  public void run()">
<meta property="og:type" content="article">
<meta property="og:title" content="Android常见内存泄漏原因以及解决方法">
<meta property="og:url" content="https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/index.html">
<meta property="og:site_name" content="SmallBlueWhale's blog">
<meta property="og:description" content="HandlerHandler出现内存泄漏的原因，handler内部持有了一个context对象，同时如果这个对象因为handler消息未发送完成导致context对象一直无法被销毁，出现内存泄漏，同时如果我们新开一个线程去发送消息的话，也会因此出现内存泄漏。如下：
123456new Thread(new Runnable()&amp;#123;  @Override  public void run()">
<meta property="og:updated_time" content="2017-07-14T09:35:20.109Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android常见内存泄漏原因以及解决方法">
<meta name="twitter:description" content="HandlerHandler出现内存泄漏的原因，handler内部持有了一个context对象，同时如果这个对象因为handler消息未发送完成导致context对象一直无法被销毁，出现内存泄漏，同时如果我们新开一个线程去发送消息的话，也会因此出现内存泄漏。如下：
123456new Thread(new Runnable()&amp;#123;  @Override  public void run()">
    
        <link rel="alternative" href="/atom.xml" title="SmallBlueWhale&#39;s blog" type="application/atom+xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="/css/style.css?v=1.4.5">
    <script>window.lazyScripts=[]</script>
</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">SmallBlueWhale</h5>
          <a href="mailto:349415101@qq.com" title="349415101@qq.com" class="mail">349415101@qq.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                标签
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.zhihu.com/people/jin-hui-18-8/activities"  >
                <i class="icon icon-lg icon-archives"></i>
                知乎
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/SmallBlueWhale" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="http://weibo.com/2353851293/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                微博
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/about"  >
                <i class="icon icon-lg icon-link"></i>
                关于
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Android常见内存泄漏原因以及解决方法</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Android常见内存泄漏原因以及解决方法</h1>
        <h5 class="subtitle">
            
                <time datetime="2017-06-09T03:23:00.000Z" itemprop="datePublished" class="page-time">
  2017-06-09
</time>


            
        </h5>
    </div>

    

</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Handler"><span class="post-toc-number">1.</span> <span class="post-toc-text">Handler</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Non-static-Inner-Class"><span class="post-toc-number">1.0.1.</span> <span class="post-toc-text">Non-static Inner Class</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#解决方法"><span class="post-toc-number">1.0.2.</span> <span class="post-toc-text">解决方法</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MVP模式的内存泄漏"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">MVP模式的内存泄漏</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#解决方式"><span class="post-toc-number">1.1.0.1.</span> <span class="post-toc-text">解决方式</span></a></li></ol></li></ol></li></ol></li></ol>
        </nav>
    </aside>
    
<article id="post-Android常见内存泄漏原因以及解决方法"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Android常见内存泄漏原因以及解决方法</h1>
        <div class="post-meta">
            <time class="post-time" title="2017年06月09日 11:23" datetime="2017-06-09T03:23:00.000Z"  itemprop="datePublished">2017-06-09</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h1 id="Handler"><a href="#Handler" class="headerlink" title="Handler"></a>Handler</h1><p><strong>Handler出现内存泄漏的原因，handler内部持有了一个context对象，同时如果这个对象因为handler消息未发送完成导致context对象一直无法被销毁，出现内存泄漏，同时如果我们新开一个线程去发送消息的话，也会因此出现内存泄漏。如下：</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable()&#123;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span></span>&#123;</div><div class="line">    </div><div class="line">  &#125;</div><div class="line">&#125;).start();</div></pre></td></tr></table></figure>
<p><strong>Runnable是一个匿名内部类，会隐含的持有外部类对象，具体原因下面</strong></p>
<h3 id="Non-static-Inner-Class"><a href="#Non-static-Inner-Class" class="headerlink" title="Non-static Inner Class"></a>Non-static Inner Class</h3><p><strong>非静态匿名内部类导致的内存泄漏问题，主要是因为非静态匿名内部类是属于外部类的一部分，所以如果这个匿名内部类的周期比外部类的周期要长的话，它会隐式引用这个外部类，同时这个外部类就因为被持有，导致无法销毁，因此就泄漏了。</strong></p>
<hr>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.hyx.maizuo.base.utils.system;</div><div class="line"><span class="keyword">import</span> android.app.Activity;</div><div class="line"><span class="keyword">import</span> android.content.SharedPreferences;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"><span class="keyword">import</span> android.support.multidex.MultiDex;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.tencent.bugly.beta.Beta;</div><div class="line"></div><div class="line"><span class="keyword">import</span> cn.com.mma.mobile.tracking.util.DeviceInfoUtil;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoadDexActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</div><div class="line">	<span class="keyword">protected</span> Context mContext;</div><div class="line">	<span class="keyword">private</span> MyHandler mHandler;</div><div class="line">  	WeakReference&lt;Activity&gt; mActivity;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">MyHandler</span> <span class="keyword">extends</span> <span class="title">Handler</span></span>&#123;</div><div class="line">	  	MyHandler(Activity activity)&#123;</div><div class="line">          	mActivity = New WeakReference&lt;Activity&gt;(activity);</div><div class="line">	  	&#125;</div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleMessage</span><span class="params">(Message msg)</span> </span>&#123;</div><div class="line">        SampleActivity activity = mActivity.get();</div><div class="line">        <span class="keyword">if</span> (mActivity != <span class="keyword">null</span>) &#123;</div><div class="line">          <span class="comment">// 做自己的操作。</span></div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">  </div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">		mHandler = <span class="keyword">new</span> Myhandler(<span class="keyword">this</span>);</div><div class="line">      	mHandler.sendEmptyMessage(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="MVP模式的内存泄漏"><a href="#MVP模式的内存泄漏" class="headerlink" title="MVP模式的内存泄漏"></a>MVP模式的内存泄漏</h2><p>首先贴一段错误的代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.support.annotation.NonNull;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.hyx.maizuo.base.utils.network.basic.ResponseException;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.ref.WeakReference;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * P层（Presenter）基类</div><div class="line"> * 需要多个模块都采用MVP模式的时候，可以考虑在commonLibrary中添加BaseMVPActivity和BaseMVPFragment</div><div class="line"> * Created by whale on 17/4/18.</div><div class="line"> *</div><div class="line"> * <span class="doctag">@TODO</span></div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BasePresenter</span>&lt;<span class="title">V</span> <span class="keyword">extends</span> <span class="title">IBaseView</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> Context mContext;</div><div class="line">    <span class="keyword">private</span> V mView;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">BasePresenter</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.mContext = getView().getContext();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 需要在Activity和Fragment的onCreate()方法中</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attachView</span><span class="params">(@NonNull V view)</span> </span>&#123;</div><div class="line">        mView = view;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 需要在Activity的onDestroy()方法或者Fragment的OnDestroyView()中分离view和presenter</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detachView</span><span class="params">()</span> </span>&#123;</div><div class="line">        mView = <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们通常会在BaseActivity中去attachView()绑定activity对象，这里的View指的就是Activity，然而，因为view在这个结构里面指的是activity，presenter持有activity的强引用，如果网络请求没中断presenter生命周期比Acitity长，或则程序某种原因退出了，没有走ondestory方法，那么这个view就会持有activity的强引用，然后内存泄漏了。</p>
<p>那么如果要解决的话，应该怎么去解决？</p>
<h4 id="解决方式"><a href="#解决方式" class="headerlink" title="解决方式"></a>解决方式</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.hyx.maizuo.base.utils.mvp;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.content.Context;</div><div class="line"><span class="keyword">import</span> android.support.annotation.NonNull;</div><div class="line"></div><div class="line"><span class="keyword">import</span> com.hyx.maizuo.base.utils.network.basic.ResponseException;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.lang.ref.WeakReference;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * P层（Presenter）基类</div><div class="line"> * 需要多个模块都采用MVP模式的时候，可以考虑在commonLibrary中添加BaseMVPActivity和BaseMVPFragment</div><div class="line"> * Created by frank on 17/4/18.</div><div class="line"> *</div><div class="line"> * <span class="doctag">@TODO</span></div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">BasePresenter</span>&lt;<span class="title">V</span> <span class="keyword">extends</span> <span class="title">IBaseView</span>&gt; </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> Context mContext;</div><div class="line">    <span class="keyword">private</span> WeakReference&lt;V&gt; mView;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="title">BasePresenter</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">this</span>.mContext = getView().getContext();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 需要在Activity和Fragment的onCreate()方法中</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attachView</span><span class="params">(@NonNull V view)</span> </span>&#123;</div><div class="line">        mView = <span class="keyword">new</span> WeakReference&lt;V&gt;(view);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 需要在Activity的onDestroy()方法或者Fragment的OnDestroyView()中分离view和presenter</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">detachView</span><span class="params">()</span> </span>&#123;</div><div class="line">        mView = <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 判断当前的VIEW引用是否为空</div><div class="line">     */</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">isViewAttached</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> mView != <span class="keyword">null</span> &amp;&amp; mView.get() != <span class="keyword">null</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>因为用的是weakReference ，这样的话android的回收机制会因为没有其它强引用去引用它的原因，将这个初始化的view回收，这样的话就不会导致内存泄漏。</p>
<p>但是用WeakReference的话，可能会有这样一种情况，系统误回收，这样我们在使用之前，最好判断它是否被回收。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">if</span>(isViewAttached())&#123;</div><div class="line">  	<span class="comment">//自己的操作</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里如果想知道更多，贴一段mosby的原文吧。</p>
<blockquote>
<p>In general I agree, it’s painful to write all those <code>isViewAttached()</code> checked.</p>
<p>First let me explain why <code>MvpBasePresenter</code> uses a <code>WeakReference</code>. Usually there is no need to wrap the <code>MvpView</code> in a <code>WeakReference</code> because:</p>
<ol>
<li>Any async call should be canceled in <code>detachView()</code>, so that no callback should be invoked afterwards. For instance with <code>RxJava</code> and <code>unsubscribe()</code> this works like a charm.</li>
<li>However, there might be scenarios where you don’t want to cancel running async background tasks, like when using retaining Fragments. But also in that case the Fragment gets detached and reattached temporarily during orientation changes. However, Mosby assumes that every interaction with the view takes place on the main UI Thread. So every interaction with the view from a callback / presenter <strong>must</strong> run on the main UI Thread. Hence it’s <strong>not possible</strong> that a callback accesses the view during a screen orientation change, since screen orientation changes run on the main ui thread as well. Therefore, either screen orientation changes run before callback or vice versa, but <strong>never</strong> in parallel.</li>
</ol>
<p>So why does Mosby’s default implementation uses a <code>WeakReference</code>?<br>The only reason why Mosby’s default implementation uses a <code>WeakReference</code> is that I wanted to avoid memory leaks if other developers misuse Mosby by writing a custom delegate that i.e. forget to call<code>presenter.detachView()</code>.</p>
<p>Thus at a first glance you might come to the conclusion that <code>View</code> can never be <code>null</code>. Unfortunately, it can be in case that <code>View</code> is detached (i.e. user has closed the activity by pressing back button) but an async running background thread has not been canceled in <code>detachView()</code>. i.e. as far as I know Retrofit 1.x has no API to cancel running requests. Therefore, we have to check if <code>view != null</code> anyway.</p>
<p>Alright, so back to your suggestion to use the null object pattern. Your implementation looks good (there is a little issue with WeakReference, I have added a comment in your commit to point out the problem) and I think in that case it is reasonable to use reflections.</p>
<p>But I have in general a problem with the null object pattern in general. I don’t like it because usually it only tries to hide other problems (might be an implementation detail like libraries that don’t support canceling async threads or a lack of java programming language syntax / expressiveness).</p>
<p>On one hand you are right and those <code>view != null</code> checks are pretty annoying. I have to think about it again, but I think we could try to find a compromise by adding those kind of base presenter, but I see it more as an addition and not as a replacement of <code>MvpBasePresenter</code>. However, having a second null object based <code>MvpNullObjectBasePresenter</code> implementation may result in having also a bunch of other presenter implemetation like <code>RxNullObjectPresenter</code>, <code>RetrofitNullObjectPresenter</code> and so on.</p>
<p>On the other hand that kind of problem could be reduced / solved by Kotlin, where you could replace</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&gt;  <span class="keyword">if</span> (isViewAttached())&#123;</div><div class="line">&gt;     getView.showContent();</div><div class="line">&gt; &#125;</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>with</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&gt; getView()?showContent()</div><div class="line">&gt;</div></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>What do you think?</p>
</blockquote>
<p><a href="http://www.androiddesignpatterns.com/2013/01/inner-class-handler-memory-leak.html" target="_blank" rel="external"> 内存泄漏之Handler &amp; InnerClass</a></p>

        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2017-07-14T09:35:20.109Z" itemprop="dateUpdated">2017年7月14日 17:35</time>
</span><br>


        
    </div>
    <footer>
        <a href="https://smallbluewhale.github.io">
            <img src="/img/avatar.jpg" alt="SmallBlueWhale">
            SmallBlueWhale
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android/">Android</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Context/">Context</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Handler-InnerClass/">Handler && InnerClass</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Memory-Leak/">Memory Leak</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Static/">Static</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/&title=《Android常见内存泄漏原因以及解决方法》 — SmallBlueWhale's blog&pic=https://smallbluewhale.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/&title=《Android常见内存泄漏原因以及解决方法》 — SmallBlueWhale's blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Android常见内存泄漏原因以及解决方法》 — SmallBlueWhale's blog&url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/&via=https://smallbluewhale.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2017/06/20/Android开发系列：“从零搭建一个mvp+retrofit+glide+rxjava+material design的应用”(三) /" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Android开发系列：“从零搭建一个mvp+retrofit+glide+rxjava+material design的应用”(三)</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2017/06/03/Android ttf字体提取/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Android TTF格式字体提取(避免添加整个字体包)</h4>
      </a>
    </div>
  
</nav>



    




<section class="comments" id="comments">
    <div id="disqus_thread"></div>
    <script>
    var disqus_shortname = 'smallbluewhale';
    lazyScripts.push('//' + disqus_shortname + '.disqus.com/embed.js')
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>




</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢哥哥~
        <i class="icon icon-quote-right"></i>
    </h3>
    <ul class="reward-items">
        
        <li>
            <img src="/img/wechat.jpg" title="微信打赏二维码" alt="微信打赏二维码">
            <p>微信</p>
        </li>
        

        
        <li>
            <img src="/img/alipay.jpg" title="支付宝打赏二维码" alt="支付宝打赏二维码">
            <p>支付宝</p>
        </li>
        
    </ul>
</div>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            <span>博客内容遵循 <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0协议</a></span>
        </p>
    </div>
    <div class="bottom">
        <p>
            <span>Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a></span>
            <span>SmallBlueWhale's blog &copy; 2015 - 2017</span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/&title=《Android常见内存泄漏原因以及解决方法》 — SmallBlueWhale's blog&pic=https://smallbluewhale.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/&title=《Android常见内存泄漏原因以及解决方法》 — SmallBlueWhale's blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Android常见内存泄漏原因以及解决方法》 — SmallBlueWhale's blog&url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/&via=https://smallbluewhale.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://smallbluewhale.github.io/2017/06/09/Android常见内存泄漏原因以及解决方法/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAADMklEQVR42u3awY7iQAwEUP7/p9nL3mY3VNkgTZqXU6Qh0K+Rxrjcj0d8PX9cP//avv7nX5NX/u96fOLCxsbGvgk7ebsWcP3UNfL6Ha6fKrYGGxsb+zj29bKutyDhXS8uRyZrS7YYGxsb+5vZbXFKClVbtPLPwsbGxsbOf+7Poqi8kXhXwcPGxsY+lZ18QFLA8oYkHxW0T705S8PGxsb+9ex8Kvr77z8y38bGxsb+xexneeUfk7cus+HB5sLGxsY+id0y2qA/2YjZAGD2NWBjY2Ofzc7j+2v2bHjwrq0pgiRsbGzsg9izOP5drUJ+ACjfoGTMjI2NjX0G+73BTQJo24xZoS0O62BjY2N/ATupgUnklI8Eiqobbw02Njb22ez2B33SGLSxVNuE5JHTfwsYNjY29nHsfHzbjntbfL6qnB1NtrGxsbFvzv5cQzJb9CcOA/29x8bGxj6OvQn9kzgpLzB5qzMb/UYfiY2NjX0rdlt42p/+s2KWL322cmxsbOyT2Hm4MxvZ5u+QwGZfzD/eARsbG/s49iysnx21yQcP7ei3CKqwsbGxD2In4c5m9NsGRrOxcbL+R14hsbGxsW/F3jQVmyOV+0JYH9PBxsbG/gJ2flBmFjC1pa4th0mc9CJLw8bGxr4hOy8h+/g+39DZyKEdPGBjY2Ofwc7/0edNxazUJa1FPn54sUHY2NjYx7H3ZSkpJJsDQG25enGPjY2NfRB7E9a/LdYpx8x5y9SOKLCxsbHvy94MWfOmYhb9t99e8RQ2Njb20ezhhGEdM30OiY2NjX02e7agNvTPW5d2VLyJxrCxsbHPYOeNRNta5Adx2hK1OUKEjY2NfSp7H+jPytgwEhqVruK8EjY2NvYN2W3AlEf57bP7MlYc0MHGxsa+OftZXvstm5XA9nhQMQ/BxsbGvjm7HdDmi2uDp327km8xNjY29nnsfBA7C3qeo6sdIbyIkNosDRsbG/uG7PwQz6zUzUKrx+J6UQ6xsbGxv5idDwM2DUkeJyX32NjY2NhtALTZmrbJmZVVbGxs7PPY+3CnbUj2r5wVWmxsbOzz2DmjHQDnTcVswLw/ToSNjY19c/Yf729KFWQt+isAAAAASUVORK5CYII=" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };



</script>

<script src="/js/main.min.js?v=1.4.5"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="/js/search.min.js?v=1.4.5" async></script>






<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


</body>
</html>
